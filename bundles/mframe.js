!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mframe=e():t.mframe=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";n.r(e);const r=/^(-?[1-9]\d*)|0$/;var i={guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},access:function(t,e,n,r){var i=t.length;if("number"==typeof i)for(var s=0;s<i;s++)r(t[s],e,n);else r(t,e,n)},each:function(t,e,n){var r=t.length;if("number"==typeof r)for(var i=0;i<r;i++)t[i][e].apply(t[i],n);else t[e].apply(t,n)},toArray:function(t){return Array.prototype.slice.call(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},int:function(t,e){var n,r=e||0;return"number"==typeof t&&(n=t>>0)>=0?n:r},isInt:function(t){return r.test(t)}},s={_regConfig:{Chrome:{Reg:/.*(chrome)\/([\w.]+).*/,CssPrefixes:"Webkit"},Firefox:{Reg:/.*(firefox)\/([\w.]+).*/,CssPrefixes:"Moz"},Opera:{Reg:/(opera).+version\/([\w.]+)/,CssPrefixes:"O"},Safari:{Reg:/.*version\/([\w.]+).*(safari).*/,CssPrefixes:"Webkit"},IE:{Reg:/.*(msie) ([\w.]+).*/,CssPrefixes:"ms"}},CssPrefixes:"",init:function(){var t=this._regConfig,e=navigator.userAgent.toLowerCase();for(var n in t){if(null!=t[n].Reg.exec(e)){this.CssPrefixes=t[n].CssPrefixes;break}}}};navigator&&navigator.userAgent&&s.init();var a=s,o={support:{},regMsPrefix:/^-ms-/,regDashAlpha:/-([\da-z])/gi,cssProps:{},camelCase:function(t){return t.replace(this.regMsPrefix,"ms-").replace(this.regDashAlpha,this.fcamelCase)},fcamelCase:function(t,e){return e.toUpperCase()},upper1st:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},vendorPropName:function(t,e){if(e in t)return e;var n=this.upper1st(e),r=e;return(e=a.CssPrefixes+n)in t?e:r},test:function(){var t,e,n;(t=document.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(n=(e=t.getElementsByTagName("a")[0])&&e.style)&&(n.cssText="float:left;opacity:.5",this.support.cssFloat=!!n.cssFloat,this.support.clearCloneStyle="content-box"===t.style.backgroundClip,this.cssProps.float=this.support.cssFloat?"cssFloat":"styleFloat",this.getComputedStyle="function"==typeof window.getComputedStyle?window.getComputedStyle:document.defaultView.getComputedStyle)},getPropName:function(t,e){return this.cssProps[e]||(this.cssProps[e]=this.vendorPropName(t,e))},css:function(t,e,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r=this.camelCase(e),i=t.style,s=this.getPropName(i,r);if(void 0===n){var a,o=i[s];if(void 0===o||""===o){try{a=document.defaultView.getComputedStyle(t)[s]}catch(t){return""}return a}return i[s]}if(null!=n&&n==n)try{i[s]=n}catch(t){}}}};o.test();var u={Cores:{css:{_set:function(t,e,n){o.css(t,e,n)},set:function(t,e,n){i.access(t,e,n,this._set)},_get:function(t,e){return o.css(t,e)},get:function(t,e){return this._get("number"==typeof t.length?t[0]:t,e)}},attr:{_set:function(t,e,n){t.setAttribute(e,n)},set:function(t,e,n){i.access(t,e,n,this._set)},_get:function(t,e){return t.getAttribute(e)},get:function(t,e){return this._get("number"==typeof t.length?t[0]:t,e)}},prop:{_set:function(t,e,n){t[e]=n},set:function(t,e,n){i.access(t,e,n,this._set)},_get:function(t,e){return t[e]},get:function(t,e){return this._get("number"==typeof t.length?t[0]:t,e)}},arg:{set:function(t,e,n){return""},get:function(t,e){return""}}},install:function(t,e){this.Cores[t]=e},uninstall:function(t){delete this.Cores[t]},createStorage:function(){var t={};for(var e in this.Cores)t[e]={};return t},core:function(t){return this.Cores[t]}},h={RegNum:/(-?\d+)(\.\d+)?/g,toRgbaArr:function(t){var e,n,r,i=1;if("#"===t[0]){var s=4===t.length?1:2;e=parseInt(t.slice(1,1+s),16),n=parseInt(t.slice(1+s,1+2*s),16),r=parseInt(t.slice(1+2*s,1+3*s),16)}else{var a=t.match(this.RegNum);e=+a[0],n=+a[1],r=+a[2],i=a.length>3?+a[3]:1}return[e,n,r,i]},toRgba:function(t){return"rgba("+t.join(",")+")"},toHex:function(t){return"#"+this.to16(t[0])+this.to16(t[1])+this.to16(t[2])},to16:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},f={add:function(t,e){this[t]=e},linear:function(t,e,n,r){return n*t/r+e},easeIn:function(t,e,n,r){return n*(t/=r)*t+e},easeOut:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOut:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0==t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t==r?e+n:n*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,n,r){return 0==t?e:t==r?e+n:(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInBounce:function(t,e,n,r){return n-f.easeOutBounce(r-t,0,n,r)+e},easeOutBounce:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,n,r){return t<r/2?.5*f.easeInBounce(2*t,0,n,r)+e:.5*f.easeOutBounce(2*t-r,0,n,r)+.5*n+e}},c=f,p=function(t,e,n){this.Keys={},this.Timing=[],this._LaterComplie={},this.Frames={},this.Dom=t,this.CpuCore=u.core(e),this.PropName=n};p.prototype={RegList:[/#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})/,/^[rR][gG][Bb][Aa]?[\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}[\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),?[\s]*(0\.\d{1,2}|1|0)?[\)]{1}$/,/(-?\d+)(\.\d+)?/],Reg:/(#([0-9a-fA-F]{6}|[0-9a-fA-F]{3}))|(([rR][gG][Bb][Aa]?[\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}[\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),?[\s]*(0\.\d{1,2}|1|0)?[\)]{1}))|((-?\d+)(\.\d+)?)/g,RegFloat:/\./g,_sort:function(t,e){return t-e},add:function(t,e,n){-1===this.Timing.indexOf(e)&&(this.Timing.push(e),this.Timing.sort(this._sort)),this.Keys[e]={value:t,tween:n}},complie:function(){var t,e,n,r,i=this.Keys,s=this.Timing;if(1!==s.length)for(var a in this._LaterComplie)t=s[+a],e=s[+a+1],n=i[t],r=i[e],this._patch(t,e,this.val(n.value),this.val(r.value),r.tween);else this.Frames[s[0]]=this.val(i[s[0]].value)},preComplie:function(){var t,e,n,r,i=this.Timing,s=this.Keys;if(this._LaterComplie={},1===i.length){var a=s[i[0]].value;return this._ifLaterComplie(a)&&(this._LaterComplie[0]=!0),void(this.Frames[i[0]]=a)}for(var o=0,u=i.length-1;o<u;o++)t=i[o],e=i[o+1],n=s[t],r=s[e],this._ifLaterComplie(n.value)||this._ifLaterComplie(r.value)?this._LaterComplie[o]=!0:this._patch(t,e,n.value,r.value,r.tween)},val:function(t){return"function"==typeof t?t():null===t?this.CpuCore.get(this.Dom,this.PropName):t},state:function(t,e,n){if(e)for(;t>=n;){if(void 0!==this.Frames[t]){this.CpuCore.set(this.Dom,this.PropName,this.Frames[t]);break}t--}else for(;t<=n;){if(void 0!==this.Frames[t]){this.CpuCore.set(this.Dom,this.PropName,this.Frames[t]);break}t++}},render:function(t){void 0!==this.Frames[t]&&this.CpuCore.set(this.Dom,this.PropName,this.Frames[t])},_patch:function(t,e,n,r,i){var s="number"==typeof n&&"number"==typeof r,a=n.toString(),o=r.toString(),u=this._match(a),h=this._match(o),f=e-t,p=c[i]||c.linear;if(f>1&&n!==r){var m=this._analyzeMatch(u,h);if(m)if(s)for(var l=t+1;l<e;l++)this.Frames[l]=+this._patchProp(a,m,l-t,f,p);else for(l=t+1;l<e;l++)this.Frames[l]=this._patchProp(a,m,l-t,f,p)}this.Frames[t]=n,this.Frames[e]=r},_number:function(t,e){return e?parseInt(t):+t},_patchProp:function(t,e,n,r,i){var s=e.start,a=e.end,o=e.int,u=this._number,f=0;return t.replace(this.Reg,(function(t){var e,c=s[f],p=a[f];if("number"==typeof c)e=u(i(n,+c,+p-c,r),o[f]);else{for(var m=[],l=0,v=c.length;l<v;l++){var g=i(n,+c[l],+p[l]-c[l],r);m.push(l<3?parseInt(g):g)}e="#"===t[0]?h.toHex(m):h.toRgba(m)}return f++,e}))},_analyzeMatch:function(t,e){var n=t.typeLike,r=e.typeLike,i=t.match,s=e.match,a=n.length,o={start:[],end:[],int:[]};if(a!==r.length||0===a||0===r.length)return!1;for(var u=0;u<a;u++){if(n[u]!==r[u])return!1;1===n[u]?(o.start.push(+i[u]),o.end.push(+s[u]),o.int.push(this._needConvertInt(i[u],s[u]))):(o.start.push(h.toRgbaArr(i[u])),o.end.push(h.toRgbaArr(s[u])),o.int.push([!0,!0,!0,!1]))}return o},_needConvertInt:function(t,e){return!(this.RegFloat.test(t)||this.RegFloat.test(e))},_match:function(t){for(var e=t.match(this.Reg)||[],n=[],r=[],i=0;i<e.length;i++){var s=this._matchType(e[i]);n.push(s),r.push(2===s?1:0)}return{match:e,type:n,typeLike:r}},_matchType:function(t){for(var e=this.RegList,n=0,r=e.length;n<r;n++)if(e[n].test(t))return n},_ifLaterComplie:function(t){return"function"==typeof t||null===t}};var m=p,l=function(){this.Events={}};l.prototype={RegInt:/^[1-9]\d*$/,bind:function(t,e){return void 0===e._$EventGuid&&(e._$EventGuid=i.guid()),void 0===this.Events[t]&&(this.Events[t]={}),this.Events[t][e._$EventGuid]=e,e._$EventGuid},binds:function(t,e){if(t){var n,r="number"==typeof e;for(var i in t)n=r&&this.RegInt.test(i)?e+i:i,this.bind(n,t[i])}},emit:function(t,e,n){var r=this.Events[t];if(r)for(var i in r)r[i].apply(n,e)},fire:function(t,e,n){var r=this.Events[t];if(r)for(var i in r)r[i].call(n,e)},unbind:function(t,e){if(this.Events[t]){var n="string"==typeof e?e:e._$EventGuid;delete this.Events[t][n]}}};var v=l,g=function(t,e){this.Dom=t.dom,this.Frames=t.frames,this.Storage=u.createStorage(),this.Events=new v,this.Events.binds(t.events),this.ZeroFrame=e||0,this._scan()};g.prototype={_store:function(t,e,n,r){if(void 0!==e){var i=this.Storage[t],s=this.Dom;for(var a in e)void 0===i[a]&&(i[a]=new m(s,t,a)),i[a].add(e[a],n,r)}},_scan:function(){for(var t,e,n,r=this.Frames,i=this.Storage,s=0,a=0,o=r.length;a<o;a++){for(var u in n=(t=r[a]).time||0,e=t.tween||"linear",i)this._store(u,t[u],n,e);s=Math.max(n,s)}this.LastFrame=s,this._excuteStorage("preComplie")},getArgs:function(t){var e,n=this.Storage.arg,r={};for(var i in n)void 0!==(e=n[i].Frames[t])&&(r[i]=e);return r},state:function(t,e){let n;if(t<this.ZeroFrame?e||(n=this.zeroFrame):t>this.LastFrame?e&&(n=this.LastFrame):n=t-this.ZeroFrame,"number"==typeof n){var r=e?this.ZeroFrame:this.LastFrame;this._excuteStorage("state",[n,e,r])}},render:function(t){if(t>=this.ZeroFrame&&t<=this.LastFrame){let e=t-this.ZeroFrame;this.Events.emit("beforeEach",[e]),this._excuteStorage("render",[e]),this.Events.emit("each",[e,this.getArgs(e)]),this.Events.emit(e)}},_excuteStorage:function(t,e){var n,r=this.Storage;for(var i in r)for(var s in n=r[i])n[s][t].apply(n[s],e)},complie:function(){this._excuteStorage("complie")}};var d=g,_=function(t,e){this.Timelines=[],this.LastFrame=0,this._AnimationID,this.CurrentFrame=0,this.Repeat=1,this.Events=new v,this.Events.binds(e),this.add(t)};_.prototype={add:function(t,e){for(var n=i.isArray(t)?t:[t],r=0,s=e?this.LastFrame:0,a=0,o=n.length;a<o;a++){var u=new d(n[a],s);this.Timelines.push(u),r=Math.max(r,u.LastFrame)}return this.LastFrame=Math.max(this.LastFrame,r),this},append:function(t){return this.add(t,!0),this},bind:function(t,e){return this.Events.bind(t,e),this},run:function(t,e,n){if(this._AnimationID)return this;var r,s,a=i.int(t,this.CurrentFrame),o=i.int(e,this.LastFrame),u=(n=n?a<=o?0:this.LastFrame:a,a),h=this;a<=o?(r=1,s=function(){return u<=o}):(r=-1,s=function(){return u>=o});var f=function(){h.Events.emit("start"),s()?(h.render(u),h._AnimationID=requestAnimationFrame(f),u+=r):(h.Repeat--,h.Repeat<=0?(h._AnimationID=null,h.Events.emit("end"),h.Repeat=1):(u=n,h.render(u),h._AnimationID=requestAnimationFrame(f)))};return this._complie(),f(),this},_complie:function(){i.each(this.Timelines,"complie")},state:function(t,e){0<=t&&t<=this.LastFrame&&(e=void 0===e||!!e,this._complie(),i.each(this.Timelines,"state",[t,e]),this.CurrentFrame=t)},render:function(t){this.Events.emit("beforeEach",[t]),i.each(this.Timelines,"render",[t]),this.Events.emit("each",[t]),this.Events.emit(t),this.CurrentFrame=t},reverse:function(){return this.run(this.CurrentFrame>0?this.CurrentFrame:this.LastFrame,0),this},repeat:function(t){this.Repeat=t,this.play()},play:function(){return this.run(),this},stop:function(){return cancelAnimationFrame(this._AnimationID),this._AnimationID=null,this.CurrentFrame=0,this.Events.emit("stop"),this},pause:function(){return cancelAnimationFrame(this._AnimationID),this._AnimationID=null,this.Events.emit("pause"),this},isPlaying:function(){return!!this._AnimationID}};var y=_,x=function(t,e,n){this._Config=i.isArray(t)?t:[t],this._Events=e,this._isFromeZero=!0,this.Mframes={1:new y(t,e)},this.CurrentSpeed=1,this.x(n)};x.prototype={x:function(t){i.isArray(t)&&t.length>0?this.xspeed(t):t&&this.xconfig(t)},_xspeed:function(t){for(var e=this._Config,n=this._u_event(this._Events,t),r=[],i=0,s=e.length;i<s;i++)r.push(this._u_config(e[i],t));return new y(r,n)},xspeed:function(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];"number"==typeof r&&1!==r&&(this.Mframes[r]=this._xspeed(r))}},xconfig:function(t){var e,n;for(var r in t)"NaN"!==(e=parseFloat(r)).toString&&1!==e&&(n=t[r],this.Mframes[e]=!0===n?this._xspeed(e):new y(n,this._u_event(this._Events,e)))},_u_time:function(t,e,n){return Math.ceil(t*n/e)},_u_config:function(t,e){var n,r={};for(var i in t)if(n=t[i],"frames"===i){for(var s,a=[],o=0,u=n.length;o<u;o++)(s=Object.assign({},n[o])).time=this._u_time(s.time,1,e),a.push(s);r.frames=a}else"events"===i?r.events=this._u_event(n,e):r[i]=n;return r},_u_event:function(t,e){if(t){var n={};for(var r in t){if(i.isInt(r))n[this._u_time(parseInt(r),1,e)]=t[r];else n[r]=t[r]}return n}return t},current:function(t){if("number"!=typeof t)return this.CurrentSpeed;this.CurrentSpeed=t},currentMframe:function(){return this.Mframes[this.CurrentSpeed]},speed:function(t){if("number"==typeof t&&t!=this.current()){void 0===this.Mframes[t]&&this.xspeed([t]);var e=this.currentMframe(),n=e.CurrentFrame,r=this.Mframes[t],i=this._u_time(n,this.current(),t),s=e.isPlaying();e.pause(),r.state(i,this._isFromeZero),r.Repeat=e.Repeat,s&&r.run(void 0,void 0,!0),this.current(t)}},play:function(){var t=this.currentMframe();t.play.apply(t,arguments)},stop:function(){var t=this.currentMframe();t.stop.apply(t,arguments)},pause:function(){var t=this.currentMframe();t.pause.apply(t,arguments)},repeat:function(){var t=this.currentMframe();t.repeat.apply(t,arguments)},reverse:function(){var t=this.currentMframe();t.reverse.apply(t,arguments)},run:function(){var t=this.currentMframe();t.run.apply(t,arguments)},state:function(){var t=this.currentMframe();t.state.apply(t,arguments)}};var C=x,b=function(t,e){return new y(t,e)};b.Cpu=u,b.Tween=c,b.speed=function(t,e,n){return new C(t,e,n)};var F=function(t,e){"undefined"!=typeof window&&void 0===window[t]&&(window[t]=e)};F("mf",b),F("mframe",b);e.default=b}]).default}));
//# sourceMappingURL=mframe.js.map