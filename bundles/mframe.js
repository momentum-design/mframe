!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.mframe=e():t.mframe=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r(r.s=0)}([function(t,e,r){t.exports=r(1)},function(t,e,r){"use strict";r.r(e);const n=/^(-?[1-9]\d*)|0$/;var i={guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},access:function(t,e,r,n){var i=t.length;if("number"==typeof i)for(var s=0;s<i;s++)n(t[s],e,r);else n(t,e,r)},each:function(t,e,r){var n=t.length;if("number"==typeof n)for(var i=0;i<n;i++)t[i][e].apply(t[i],r);else t[e].apply(t,r)},toArray:function(t){return Array.prototype.slice.call(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},int:function(t,e){var r,n=e||0;return"number"==typeof t&&(r=t>>0)>=0?r:n},isInt:function(t){return n.test(t)}},s={_regConfig:{Chrome:{Reg:/.*(chrome)\/([\w.]+).*/,CssPrefixes:"Webkit"},Firefox:{Reg:/.*(firefox)\/([\w.]+).*/,CssPrefixes:"Moz"},Opera:{Reg:/(opera).+version\/([\w.]+)/,CssPrefixes:"O"},Safari:{Reg:/.*version\/([\w.]+).*(safari).*/,CssPrefixes:"Webkit"},IE:{Reg:/.*(msie) ([\w.]+).*/,CssPrefixes:"ms"}},CssPrefixes:"",init:function(){var t=this._regConfig,e=navigator.userAgent.toLowerCase();for(var r in t){if(null!=t[r].Reg.exec(e)){this.CssPrefixes=t[r].CssPrefixes;break}}}};navigator&&navigator.userAgent&&s.init();var a=s,o={support:{},regMsPrefix:/^-ms-/,regDashAlpha:/-([\da-z])/gi,cssProps:{},camelCase:function(t){return t.replace(this.regMsPrefix,"ms-").replace(this.regDashAlpha,this.fcamelCase)},fcamelCase:function(t,e){return e.toUpperCase()},upper1st:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},vendorPropName:function(t,e){if(e in t)return e;var r=this.upper1st(e),n=e;return(e=a.CssPrefixes+r)in t?e:n},test:function(){var t,e,r;(t=document.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(r=(e=t.getElementsByTagName("a")[0])&&e.style)&&(r.cssText="float:left;opacity:.5",this.support.cssFloat=!!r.cssFloat,this.support.clearCloneStyle="content-box"===t.style.backgroundClip,this.cssProps.float=this.support.cssFloat?"cssFloat":"styleFloat",this.getComputedStyle="function"==typeof window.getComputedStyle?window.getComputedStyle:document.defaultView.getComputedStyle)},getPropName:function(t,e){return this.cssProps[e]||(this.cssProps[e]=this.vendorPropName(t,e))},css:function(t,e,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var n=this.camelCase(e),i=t.style,s=this.getPropName(i,n);if(void 0===r){var a,o=i[s];if(void 0===o||""===o){try{a=document.defaultView.getComputedStyle(t)[s]}catch(t){return""}return a}return i[s]}if(null!=r&&r==r)try{i[s]=r}catch(t){}}}};o.test();var u={Cores:{css:{_set:function(t,e,r){o.css(t,e,r)},set:function(t,e,r){i.access(t,e,r,this._set)},_get:function(t,e){return o.css(t,e)},get:function(t,e){return this._get("number"==typeof t.length?t[0]:t,e)}},attr:{_set:function(t,e,r){t.setAttribute(e,r)},set:function(t,e,r){i.access(t,e,r,this._set)},_get:function(t,e){return t.getAttribute(e)},get:function(t,e){return this._get("number"==typeof t.length?t[0]:t,e)}},prop:{_set:function(t,e,r){t[e]=r},set:function(t,e,r){i.access(t,e,r,this._set)},_get:function(t,e){return t[e]},get:function(t,e){return this._get("number"==typeof t.length?t[0]:t,e)}},arg:{set:function(t,e,r){return""},get:function(t,e){return""}}},install:function(t,e){this.Cores[t]=e},uninstall:function(t){delete this.Cores[t]},createStorage:function(){var t={};for(var e in this.Cores)t[e]={};return t},core:function(t){return this.Cores[t]}},h={RegNum:/(-?\d+)(\.\d+)?/g,toRgbaArr:function(t){var e,r,n,i=1;if("#"===t[0]){var s=4===t.length?1:2;e=parseInt(t.slice(1,1+s),16),r=parseInt(t.slice(1+s,1+2*s),16),n=parseInt(t.slice(1+2*s,1+3*s),16)}else{var a=t.match(this.RegNum);e=+a[0],r=+a[1],n=+a[2],i=a.length>3?+a[3]:1}return[e,r,n,i]},toRgba:function(t){return"rgba("+t.join(",")+")"},toHex:function(t){return"#"+this.to16(t[0])+this.to16(t[1])+this.to16(t[2])},to16:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},f={add:function(t,e){this[t]=e},linear:function(t,e,r,n){return r*t/n+e},easeIn:function(t,e,r,n){return r*(t/=n)*t+e},easeOut:function(t,e,r,n){return-r*(t/=n)*(t-2)+e},easeInOut:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,r,n){return r*(t/=n)*t*t+e},easeOutCubic:function(t,e,r,n){return r*((t=t/n-1)*t*t+1)+e},easeInOutCubic:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t*t+e:r/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,r,n){return r*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,r,n){return-r*((t=t/n-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t*t*t+e:-r/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,r,n){return r*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,r,n){return r*((t=t/n-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,r,n){return(t/=n/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,r,n){return-r*Math.cos(t/n*(Math.PI/2))+r+e},easeOutSine:function(t,e,r,n){return r*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,r,n){return-r/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,r,n){return 0==t?e:r*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,r,n){return t==n?e+r:r*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,r,n){return 0==t?e:t==n?e+r:(t/=n/2)<1?r/2*Math.pow(2,10*(t-1))+e:r/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,r,n){return-r*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOutCirc:function(t,e,r,n){return r*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOutCirc:function(t,e,r,n){return(t/=n/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+e:r/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInBounce:function(t,e,r,n){return r-f.easeOutBounce(n-t,0,r,n)+e},easeOutBounce:function(t,e,r,n){return(t/=n)<1/2.75?r*(7.5625*t*t)+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,e,r,n){return t<n/2?.5*f.easeInBounce(2*t,0,r,n)+e:.5*f.easeOutBounce(2*t-n,0,r,n)+.5*r+e}},c=f,p=function(t,e,r){this.Keys={},this.Timing=[],this._LaterComplie={},this.Frames={},this.Dom=t,this.CpuCore=u.core(e),this.PropName=r};p.prototype={RegList:[/#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})/,/^[rR][gG][Bb][Aa]?[\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}[\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),?[\s]*(0\.\d{1,2}|1|0)?[\)]{1}$/,/(-?\d+)(\.\d+)?/],Reg:/(#([0-9a-fA-F]{6}|[0-9a-fA-F]{3}))|(([rR][gG][Bb][Aa]?[\(]([\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),){2}[\s]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),?[\s]*(0\.\d{1,2}|1|0)?[\)]{1}))|((-?\d+)(\.\d+)?)/g,RegFloat:/\./g,_sort:function(t,e){return t-e},add:function(t,e,r){-1===this.Timing.indexOf(e)&&(this.Timing.push(e),this.Timing.sort(this._sort)),this.Keys[e]={value:t,tween:r}},complie:function(){var t,e,r,n,i=this.Keys,s=this.Timing;if(1!==s.length)for(var a in this._LaterComplie)t=s[+a],e=s[+a+1],r=i[t],n=i[e],this._patch(t,e,this.val(r.value),this.val(n.value),n.tween);else this.Frames[s[0]]=this.val(i[s[0]].value)},preComplie:function(){var t,e,r,n,i=this.Timing,s=this.Keys;if(this._LaterComplie={},1===i.length){var a=s[i[0]].value;return this._ifLaterComplie(a)&&(this._LaterComplie[0]=!0),void(this.Frames[i[0]]=a)}for(var o=0,u=i.length-1;o<u;o++)t=i[o],e=i[o+1],r=s[t],n=s[e],this._ifLaterComplie(r.value)||this._ifLaterComplie(n.value)?this._LaterComplie[o]=!0:this._patch(t,e,r.value,n.value,n.tween)},val:function(t){return"function"==typeof t?t():null===t?this.CpuCore.get(this.Dom,this.PropName):t},state:function(t,e,r){if(e)for(;t>=r;){if(void 0!==this.Frames[t]){this.CpuCore.set(this.Dom,this.PropName,this.Frames[t]);break}t--}else for(;t<=r;){if(void 0!==this.Frames[t]){this.CpuCore.set(this.Dom,this.PropName,this.Frames[t]);break}t++}},render:function(t){void 0!==this.Frames[t]&&this.CpuCore.set(this.Dom,this.PropName,this.Frames[t])},_patch:function(t,e,r,n,i){var s="number"==typeof r&&"number"==typeof n,a=r.toString(),o=n.toString(),u=this._match(a),h=this._match(o),f=e-t,p=c[i]||c.linear;if(f>1&&r!==n){var m=this._analyzeMatch(u,h);if(m)if(s)for(var l=t+1;l<e;l++)this.Frames[l]=+this._patchProp(a,m,l-t,f,p);else for(l=t+1;l<e;l++)this.Frames[l]=this._patchProp(a,m,l-t,f,p)}this.Frames[t]=r,this.Frames[e]=n},_number:function(t,e){return e?parseInt(t):+t},_patchProp:function(t,e,r,n,i){var s=e.start,a=e.end,o=e.int,u=this._number,f=0;return t.replace(this.Reg,(function(t){var e,c=s[f],p=a[f];if("number"==typeof c)e=u(i(r,+c,+p-c,n),o[f]);else{for(var m=[],l=0,v=c.length;l<v;l++){var g=i(r,+c[l],+p[l]-c[l],n);m.push(l<3?parseInt(g):g)}e="#"===t[0]?h.toHex(m):h.toRgba(m)}return f++,e}))},_analyzeMatch:function(t,e){var r=t.typeLike,n=e.typeLike,i=t.match,s=e.match,a=r.length,o={start:[],end:[],int:[]};if(a!==n.length||0===a||0===n.length)return!1;for(var u=0;u<a;u++){if(r[u]!==n[u])return!1;1===r[u]?(o.start.push(+i[u]),o.end.push(+s[u]),o.int.push(this._needConvertInt(i[u],s[u]))):(o.start.push(h.toRgbaArr(i[u])),o.end.push(h.toRgbaArr(s[u])),o.int.push([!0,!0,!0,!1]))}return o},_needConvertInt:function(t,e){return!(this.RegFloat.test(t)||this.RegFloat.test(e))},_match:function(t){for(var e=t.match(this.Reg)||[],r=[],n=[],i=0;i<e.length;i++){var s=this._matchType(e[i]);r.push(s),n.push(2===s?1:0)}return{match:e,type:r,typeLike:n}},_matchType:function(t){for(var e=this.RegList,r=0,n=e.length;r<n;r++)if(e[r].test(t))return r},_ifLaterComplie:function(t){return"function"==typeof t||null===t}};var m=p,l=function(){this.Events={}};l.prototype={RegInt:/^[1-9]\d*$/,bind:function(t,e){return void 0===e._$EventGuid&&(e._$EventGuid=i.guid()),void 0===this.Events[t]&&(this.Events[t]={}),this.Events[t][e._$EventGuid]=e,e._$EventGuid},binds:function(t,e){if(t){var r,n="number"==typeof e;for(var i in t)r=n&&this.RegInt.test(i)?e+i:i,this.bind(r,t[i])}},emit:function(t,e,r){var n=this.Events[t];if(n)for(var i in n)n[i].apply(r,e)},fire:function(t,e,r){var n=this.Events[t];if(n)for(var i in n)n[i].call(r,e)},unbind:function(t,e){if(this.Events[t]){var r="string"==typeof e?e:e._$EventGuid;delete this.Events[t][r]}}};var v=l,g=function(t,e){this.Dom=t.dom,this.Frames=t.frames,this.Storage=u.createStorage(),this.Events=new v,this.Events.binds(t.events),this.ZeroFrame=e||0,this._scan()};g.prototype={_store:function(t,e,r,n){if(void 0!==e){var i=this.Storage[t],s=this.Dom;for(var a in e)void 0===i[a]&&(i[a]=new m(s,t,a)),i[a].add(e[a],r,n)}},_scan:function(){for(var t,e,r,n=this.Frames,i=this.Storage,s=0,a=0,o=n.length;a<o;a++){for(var u in r=(t=n[a]).time||0,e=t.tween||"linear",i)this._store(u,t[u],r,e);s=Math.max(r,s)}this.LastFrame=s,this._excuteStorage("preComplie")},getArgs:function(t){var e,r=this.Storage.arg,n={};for(var i in r)void 0!==(e=r[i].Frames[t])&&(n[i]=e);return n},state:function(t,e){let r;if(t<this.ZeroFrame?e||(r=this.zeroFrame):t>this.LastFrame?e&&(r=this.LastFrame):r=t-this.ZeroFrame,"number"==typeof r){var n=e?this.ZeroFrame:this.LastFrame;this._excuteStorage("state",[r,e,n])}},render:function(t){if(t>=this.ZeroFrame&&t<=this.LastFrame){let e=t-this.ZeroFrame;this.Events.emit("beforeEach",[e]),this._excuteStorage("render",[e]),this.Events.emit("each",[e,this.getArgs(e)]),this.Events.emit(e)}},_excuteStorage:function(t,e){var r,n=this.Storage;for(var i in n)for(var s in r=n[i])r[s][t].apply(r[s],e)},complie:function(){this._excuteStorage("complie")}};var d=g,_=function(t,e){this.Timelines=[],this.LastFrame=0,this._AnimationID,this.CurrentFrame=0,this.Repeat=1,this.Events=new v,this.Events.binds(e),this.add(t)};_.prototype={add:function(t,e){for(var r=i.isArray(t)?t:[t],n=0,s=e?this.LastFrame:0,a=0,o=r.length;a<o;a++){var u=new d(r[a],s);this.Timelines.push(u),n=Math.max(n,u.LastFrame)}return this.LastFrame=Math.max(this.LastFrame,n),this},append:function(t){return this.add(t,!0),this},bind:function(t,e){return this.Events.bind(t,e),this},run:function(t,e,r){if(this._AnimationID)return this;var n,s,a=i.int(t,this.CurrentFrame),o=i.int(e,this.LastFrame),u=(r=r?a<=o?0:this.LastFrame:a,a),h=this;a<=o?(n=1,s=function(){return u<=o}):(n=-1,s=function(){return u>=o});var f=function(){h.Events.emit("start"),s()?(h.render(u),h._AnimationID=requestAnimationFrame(f),u+=n):(h.Repeat--,h.Repeat<=0?(h._AnimationID=null,h.Events.emit("end"),h.Repeat=1):(u=r,h.render(u),h._AnimationID=requestAnimationFrame(f)))};return this._complie(),f(),this},_complie:function(){i.each(this.Timelines,"complie")},state:function(t,e){0<=t&&t<=this.LastFrame&&(e=void 0===e||!!e,this._complie(),i.each(this.Timelines,"state",[t,e]),this.CurrentFrame=t)},render:function(t){this.Events.emit("beforeEach",[t]),i.each(this.Timelines,"render",[t]),this.Events.emit("each",[t]),this.Events.emit(t),this.CurrentFrame=t},reverse:function(){return this.run(this.CurrentFrame>0?this.CurrentFrame:this.LastFrame,0),this},repeat:function(t){this.Repeat=t,this.play()},play:function(){return this.run(),this},stop:function(){return cancelAnimationFrame(this._AnimationID),this._AnimationID=null,this.CurrentFrame=0,this.Events.emit("stop"),this},pause:function(){return cancelAnimationFrame(this._AnimationID),this._AnimationID=null,this.Events.emit("pause"),this},isPlaying:function(){return!!this._AnimationID}};var y=_;var x=class{constructor(t,e,r){this._Config=i.isArray(t)?t:[t],this._Events=e,this._isFromeZero=!0,this.Mframes={1:new y(t,e)},this.CurrentSpeed=1,this.x(r)}x(t){i.isArray(t)&&t.length>0?this.xspeed(t):t&&this.xconfig(t)}_xspeed(t){for(var e=this._Config,r=this._u_event(this._Events,t),n=[],i=0,s=e.length;i<s;i++)n.push(this._u_config(e[i],t));return new y(n,r)}xspeed(t){for(var e=0,r=t.length;e<r;e++){var n=t[e];"number"==typeof n&&1!==n&&(this.Mframes[n]=this._xspeed(n))}}xconfig(t){var e,r;for(var n in t)"NaN"!==(e=parseFloat(n)).toString&&1!==e&&(r=t[n],this.Mframes[e]=!0===r?this._xspeed(e):new y(r,this._u_event(this._Events,e)))}_u_time(t,e,r){return Math.ceil(t*r/e)}_u_config(t,e){var r,n={};for(var i in t)if(r=t[i],"frames"===i){for(var s,a=[],o=0,u=r.length;o<u;o++)(s=Object.assign({},r[o])).time=this._u_time(s.time,1,e),a.push(s);n.frames=a}else"events"===i?n.events=this._u_event(r,e):n[i]=r;return n}_u_event(t,e){if(t){var r={};for(var n in t){if(i.isInt(n))r[this._u_time(parseInt(n),1,e)]=t[n];else r[n]=t[n]}return r}return t}current(t){if("number"!=typeof t)return this.CurrentSpeed;this.CurrentSpeed=t}currentMframe(){return this.Mframes[this.CurrentSpeed]}speed(t){if("number"==typeof t){void 0===this.Mframes[t]&&this.xspeed([t]);var e=this.currentMframe(),r=e.CurrentFrame,n=this.Mframes[t],i=this._u_time(r,this.current(),t),s=e.isPlaying();e.pause(),n.state(i,this._isFromeZero),n.Repeat=e.Repeat,s&&n.run(void 0,void 0,!0),this.current(t)}}play(){var t=this.currentMframe();t.play.apply(t,arguments)}stop(){var t=this.currentMframe();t.stop.apply(t,arguments)}pause(){var t=this.currentMframe();t.pause.apply(t,arguments)}repeat(){var t=this.currentMframe();t.repeat.apply(t,arguments)}reverse(){var t=this.currentMframe();t.reverse.apply(t,arguments)}run(){var t=this.currentMframe();t.run.apply(t,arguments)}state(){var t=this.currentMframe();t.state.apply(t,arguments)}},C=function(t,e){return new y(t,e)};C.Cpu=u,C.Tween=c,C.speed=function(t,e,r){return new x(t,e,r)};var b=function(t,e){"undefined"!=typeof window&&void 0===window[t]&&(window[t]=e)};b("mf",C),b("mframe",C);e.default=C}]).default}));
//# sourceMappingURL=mframe.js.map